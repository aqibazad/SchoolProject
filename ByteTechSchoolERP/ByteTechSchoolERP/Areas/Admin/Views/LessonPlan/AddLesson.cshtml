
@model ByteTechSchoolERP.Models.Lesson.Lesson
@{
    ViewData["Title"] = "Add New Lesson";
    var classes = ViewBag.Classes as List<ByteTechSchoolERP.Models.ClassAndSection.Class>;
    var sections = ViewBag.Sections as List<ByteTechSchoolERP.Models.ClassAndSection.Section>;

}
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

</head>
<style>


    .style-0 {
        border-radius: 10px;
        background: #fff;
        vertical-align: middle;
        font-size: 16px;
        padding: 20px;
        flex: 0 0 100%;
        position: relative;
        max-width: 97%;
        min-height: 1px;
        padding-right: 10px;
        padding-left: 10px;
        box-sizing: border-box;
        margin-top: 20px;
    }





    .icon-container {
        text-align: center;
        margin: 0px 5px;
        background-color: white;
        border-radius: 15px;
        transition: transform 0.2s, box-shadow 0.2s;
        margin-bottom: 5px;
        margin-top: 5px;
    }

        .icon-container i {
            font-size: 3em;
            color: blueviolet;
        }

        .icon-container:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .icon-container a {
            color: inherit;
            text-decoration: none;
        }

    .ss {
        width: 7.333%;
    }

    .style-0 {
        background: #fff;
       /*  box-shadow: 0px 0px 1px 0px gray;
        box-shadow: rgb(128, 128, 128) 0px 0px 1px 0px; */
        -webkit-box-flex: 0;
        flex: 0 0 33.3333%;
        margin-bottom: 20px;
        padding-top: 20px;
        padding: 20px;
        border-radius: 15px;
        position: relative;
        width: 100%;
        min-height: 1px;
        padding-right: 20px;
        padding-left: 20px;
        box-sizing: border-box;
    }

    .style-1 {
        line-height: 16px;
        text-align: center;
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 8px;
        font-family: Poppins, sans-serif;
        color: rgb(34, 34, 34);
        margin-top: 0px;
        box-sizing: border-box;
    }

    .style-2 {
        box-sizing: border-box;
    }

    .style-3 {
        width: 15px;
        height: 6px;
        border-radius: 10px;
        display: inline-block;
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(94, 114, 228) 0px, rgb(130, 94, 228) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        box-sizing: border-box;
    }

    .style-4 {
        display: inline-block;
        font-weight: 100;
        font-size: 10px;
        color: rgb(77, 76, 172);
        box-sizing: border-box;
    }

    .style-5 {
        width: 20px;
        height: 7px;
        border-radius: 10px;
        display: inline-block;
        margin-left: 10px;
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(136, 152, 170) 0px, rgb(136, 138, 170) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        box-sizing: border-box;
    }

    .style-6 {
        display: inline-block;
        font-weight: 100;
        font-size: 12px;
        box-sizing: border-box;
    }

    .style-7 {
        box-sizing: border-box;
    }

    .style-8 {
        border: 0.666667px solid rgb(150, 152, 214);
        border-radius: 25px;
        margin-top: 15px;
        box-sizing: border-box;
        padding: 5px;
    }

    .style-9 {
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(94, 114, 228) 0px, rgb(130, 94, 228) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        margin-top: -10px;
        position: absolute;
        margin-left: 8px;
        padding-left: 3px;
        padding-right: 3px;
        font-size: 12px;
        color: rgb(255, 255, 255);
        display: block;
        margin-bottom: 8px;
        touch-action: manipulation;
        box-sizing: border-box;
        border: 0.666667px solid rgb(153, 153, 153);
        border-radius: 12px;
    }

    .style-10 {
        width: 80px;
        height: 80px;
        height: 80px;
        margin: 10px;
        border-radius: 50%;
        vertical-align: middle;
        border-style: none;
        box-sizing: border-box;
    }

    .style-11 {
        font-size: 14px;
        border-radius: 25px;
        border: 0px none rgb(73, 80, 87);
        display: block;
        width: 100%;
        padding: 8px 12px;
        line-height: 17.5px;
        color: rgb(73, 80, 87);
        background-color: rgb(255, 255, 255);
        background-image: none;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        overflow: hidden;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

    .style-12 {
        display: inline-block;
        border-radius: 20px;
        padding: 8px 14px;
        line-height: 16px;
        font-size: 11px;
        text-transform: capitalize;
        cursor: pointer;
        color: rgb(255, 255, 255);
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(94, 114, 228) 0px, rgb(130, 94, 228) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        font-weight: 400;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        user-select: none;
        border: 0.666667px solid rgba(0, 0, 0, 0);
        transition: all 0.15s ease-in-out 0s;
        box-sizing: border-box;
    }

    .style-13 {
        margin-right: 5px;
        font-family: themify;
        font-style: normal;
        font-weight: 400;
        font-variant: normal;
        text-transform: none;
        line-height: 11px;
        -webkit-font-smoothing: antialiased;
        box-sizing: border-box;
    }

    .style-14 {
        font-size: 10px;
        padding-left: 5px;
        padding-right: 5px;
        padding-right: 5px;
        background: rgba(0, 0, 0, 0) linear-gradient(45deg, rgb(255, 182, 77), rgb(255, 203, 128)) repeat scroll 0% 0% / auto padding-box border-box;
        margin-left: 10px;
        margin-top: 0px;
        border-radius: 15px;
        box-sizing: border-box;
    }

    .style-15 {
        border: 0.666667px solid rgb(150, 152, 214);
        border-radius: 25px;
        margin-top: 15px;
        box-sizing: border-box;
        padding: 5px;
    }

    .style-16 {
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(94, 114, 228) 0px, rgb(130, 94, 228) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        margin-top: -10px;
        position: absolute;
        margin-left: 8px;
        padding-left: 3px;
        padding-right: 3px;
        font-size: 12px;
        color: rgb(255, 255, 255);
        display: block;
        margin-bottom: 8px;
        touch-action: manipulation;
        box-sizing: border-box;
        border: 0.666667px solid rgb(153, 153, 153);
        border-radius: 12px;
    }

    .style-17 {
        font-size: 14px;
        border-radius: 25px;
        border: 0px none rgb(73, 80, 87);
        display: block;
        width: 100%;
        padding: 8px 12px;
        line-height: 17.5px;
        color: rgb(73, 80, 87);
        background-color: rgb(255, 255, 255);
        background-image: none;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        overflow: visible;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

    .style-18 {
        border: 0.666667px solid rgb(150, 152, 214);
        border-radius: 25px;
        margin-top: 15px;
        box-sizing: border-box;
        padding: 5px;
    }

    .style-19 {
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(94, 114, 228) 0px, rgb(130, 94, 228) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        margin-top: -10px;
        position: absolute;
        margin-left: 8px;
        padding-left: 3px;
        padding-right: 3px;
        font-size: 12px;
        color: rgb(255, 255, 255);
        display: block;
        margin-bottom: 8px;
        touch-action: manipulation;
        box-sizing: border-box;
        border: 0.666667px solid rgb(153, 153, 153);
        border-radius: 12px;
    }

    .style-20 {
        font-size: 14px;
        border-radius: 25px;
        border: 0px none rgb(73, 80, 87);
        display: block;
        width: 100%;
        padding: 8px 12px;
        line-height: 17.5px;
        color: rgb(73, 80, 87);
        background-color: rgb(255, 255, 255);
        background-image: none;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        overflow: visible;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

    .style-21 {
        border: 0.666667px solid rgb(150, 152, 214);
        border-radius: 25px;
        margin-top: 15px;
        box-sizing: border-box;
        padding: 5px;
    }

    .style-22 {
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(94, 114, 228) 0px, rgb(130, 94, 228) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        margin-top: -10px;
        position: absolute;
        margin-left: 8px;
        padding-left: 3px;
        padding-right: 3px;
        font-size: 12px;
        color: rgb(255, 255, 255);
        display: block;
        margin-bottom: 8px;
        touch-action: manipulation;
        box-sizing: border-box;
        border: 0.666667px solid rgb(153, 153, 153);
        border-radius: 12px;
    }

    .style-23 {
        font-size: 14px;
        border-radius: 25px;
        border: 0px none rgb(73, 80, 87);
        display: block;
        width: 100%;
        padding: 8px 12px;
        line-height: 17.5px;
        color: rgb(73, 80, 87);
        background-color: rgb(255, 255, 255);
        background-image: none;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        overflow: visible;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

    .style-24 {
        border: 0.666667px solid rgb(150, 152, 214);
        border-radius: 25px;
        margin-top: 15px;
        box-sizing: border-box;
        padding: 5px;
    }

    .style-25 {
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(136, 152, 170) 0px, rgb(136, 138, 170) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        margin-top: -10px;
        position: absolute;
        margin-left: 8px;
        padding-left: 3px;
        padding-right: 3px;
        font-size: 12px;
        color: rgb(255, 255, 255);
        display: block;
        margin-bottom: 8px;
        touch-action: manipulation;
        box-sizing: border-box;
        border: 0.666667px solid rgb(153, 153, 153);
        border-radius: 12px;
    }

    .style-26 {
        font-size: 14px;
        border-radius: 25px;
        border: 0px none rgb(73, 80, 87);
        display: block;
        width: 100%;
        padding: 8px 12px;
        line-height: 17.5px;
        color: rgb(73, 80, 87);
        background-color: rgb(255, 255, 255);
        background-image: none;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        overflow: auto;
        resize: vertical;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

    .style-27 {
        text-align: center;
        margin-top: 15px;
        font-size: 14px;
        margin-bottom: 16px;
        box-sizing: border-box;
    }

    .style-28 {
        border-radius: 25px;
        text-transform: capitalize;
        font-size: 15px;
        padding: 10px 19px;
        cursor: pointer;
        background: rgba(0, 0, 0, 0) linear-gradient(45deg, rgb(255, 182, 77), rgb(255, 203, 128)) repeat scroll 0% 0% / auto padding-box border-box;
        display: inline-block;
        font-weight: 400;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        user-select: none;
        line-height: 18.75px;
        transition: all 0.15s ease-in-out 0s;
        appearance: button;
        overflow: visible;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

    .style-29 {
        margin-right: 5px;
        font-family: themify;
        font-style: normal;
        font-weight: 400;
        font-variant: normal;
        text-transform: none;
        line-height: 15px;
        -webkit-font-smoothing: antialiased;
        box-sizing: border-box;
    }

    #customTableContainer {
        margin-top: 3rem;
    }

    .custom-table-container {
        background: #fff;
        box-shadow: 0px 0px 1px 0px gray;
        padding: 20px;
        border-radius: 15px;
        max-width: 100%;
        position: relative;
        width: 100%;
        min-height: 1px;
        padding-right: 20px;
        padding-left: 20px;
    }

    .custom-table-header {
        position: relative;
        clear: both;
    }

    .custom-table-header-left {
        color: rgb(51, 51, 51);
        float: left;
    }

    .custom-table-header-right {
        color: rgb(51, 51, 51);
        float: right;
        text-align: right;
    }

    .table-label {
        display: inline-block;
        margin-bottom: 8px;
    }

    #searchInput {
        border: 0.666667px solid rgb(170, 170, 170);
        border-radius: 3px;
        padding: 5px;
        background-color: rgba(0, 0, 0, 0);
        margin-left: 3px;
        outline-offset: -2px;
        appearance: none;
        overflow: visible;
        margin: 0px 0px 0px 3px;
        font-family: Poppins, sans-serif;
        font-size: 14px;
        line-height: 21px;
        color: rgb(65, 80, 148);
        padding-left: 5px;
    }

    #customTable {
        width: 100%;
        border-bottom: 0.666667px solid rgb(17, 17, 17);
        margin: 0px auto;
        clear: both;
        border-collapse: collapse;
        border-spacing: 0px 0px;
        max-width: 100%;
        margin-bottom: 0px;
        background-color: rgba(0, 0, 0, 0);
    }

        #customTable thead {
            border-bottom: 2px solid #f6f7fb;
            color: rgb(255, 255, 255);
            background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(94, 114, 228) 0px, rgb(130, 94, 228) 100%) repeat scroll 0% 0% / auto padding-box border-box;
        }

        #customTable th {
            padding: 10px 18px;
            border-bottom: 0.666667px solid rgb(17, 17, 17);
            font-weight: 700;
            white-space: nowrap;
            border-bottom-color: rgb(17, 17, 17);
            vertical-align: bottom;
            border-top: 0.666667px solid rgb(233, 236, 239);
            text-align: left;
        }

        #customTable td {
            padding: 20px 10px 15px;
            text-align: center;
            white-space: nowrap;
            vertical-align: top;
            border-top: 0.666667px solid rgb(233, 236, 239);
            padding-top: 20px;
            padding-bottom: 15px;
        }

    .classFormData {
        background: #fff;
        box-shadow: 0px 0px 1px 0px gray;
        flex: 0 0 50%;
        max-width: 50%;
        padding: 20px;
        border-radius: 15px;
        position: relative;
        width: 100%;
        min-height: 1px;
        padding-right: 20px;
        padding-left: 20px;
        box-sizing: border-box;
    }

    .formTitle {
        line-height: 16px;
        text-align: center;
        margin-top: 10px;
        margin: 10px 0px 0px;
        font-weight: 600;
        width: 100% !important;
        font-size: 20px;
        margin-bottom: 0px;
        font-family: Poppins, sans-serif;
        color: rgb(34, 34, 34);
        box-sizing: border-box;
    }

    .formLabel {
        background: rgba(0, 0, 0, 0) linear-gradient(87deg, rgb(94, 114, 228) 0px, rgb(130, 94, 228) 100%);
        padding-left: 3px;
        padding-right: 3px;
        font-size: 12px;
        color: rgb(255, 255, 255);
        display: block;
        margin-bottom: 8px;
        touch-action: manipulation;
        box-sizing: border-box;
        border: 0.666667px solid rgb(153, 153, 153);
        border-radius: 12px;
    }

    .requiredLabel {
        margin-top: -10px;
        position: absolute;
        margin-left: 8px;
    }

    .formInput {
        font-size: 14px;
        border-radius: 25px;
        border: 0px none rgb(73, 80, 87);
        display: block;
        width: 100%;
        padding: 8px 12px;
        line-height: 17.5px;
        color: rgb(73, 80, 87);
        background-color: rgb(255, 255, 255);
        background-image: none;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        overflow: visible;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

    .inputContainer {
        border: 0.666667px solid rgb(150, 152, 214);
        border-radius: 25px;
        margin-top: 15px;
        padding: 5px;
        box-sizing: border-box;
    }

    .formSelect {
        font-size: 14px;
        border-radius: 25px;
        border: 0px none rgb(73, 80, 87);
        height: 38px;
        width: 100%;
        padding: 8px 12px;
        line-height: normal;
        color: rgb(73, 80, 87);
        background-color: rgb(255, 255, 255);
        background-image: none;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        text-transform: none;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

    .selectDropdown {
        padding: 0px;
        height: auto;
        border: 0px none rgb(73, 80, 87);
        background: rgba(0, 0, 0, 0) none repeat scroll 0px 0px / auto padding-box border-box;
        box-shadow: none;
        border-radius: 25px;
        position: relative;
        font-size: 14px;
        display: block;
        width: 100%;
        line-height: 17.5px;
        color: rgb(73, 80, 87);
        background-color: rgba(0, 0, 0, 0);
        background-image: none;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        box-sizing: border-box;
    }

    .buttonContainer {
        text-align: center;
        margin-bottom: 20px;
        margin-top: 30px;
        box-sizing: border-box;
    }

    .formButton {
        border-radius: 25px;
        text-transform: capitalize;
        font-size: 15px;
        padding: 10px 19px;
        cursor: pointer;
        background: rgba(0, 0, 0, 0) linear-gradient(45deg, rgb(255, 182, 77), rgb(255, 203, 128)) repeat scroll 0% 0% / auto padding-box border-box;
        display: inline-block;
        font-weight: 400;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        user-select: none;
        line-height: 18.75px;
        transition: all 0.15s ease-in-out 0s;
        appearance: button;
        overflow: visible;
        margin: 0px;
        font-family: Poppins, sans-serif;
        touch-action: manipulation;
        box-sizing: border-box;
    }

</style>
<div class="page-wrapper">


    <div class="tab-container container-fluid">


        <div class="col-md-12">

            <div class="style-0" style="max-width: 100%;margin-left: 5px;">
                <strong>Lesson</strong> |
                <i class="fas fa-home home-icon"></i> -  Add Lesson 
            </div>
        </div>


    </div>

    <div class="tab-container container-fluid d-md-flex">
        <div class="col-md-4 " id="classFormContainer">
            <div class="style-0" style="max-width:100%; margin:0px;" id="classFormData">
                <form id="addLessonForm" method="post">
                    <div class="col-12 d-flex justify-content-center">
              <h5 class="formTitle">Create Lesson  </h5>
              </div>
              <br />


                    <div class="col-md-12 local-forms label">
                        <div style="position: relative;">
                            <label id="label-color">Class<span class="login-danger">*</span></label>

                            <select asp-for="ClassId"  class="form1-input form-select" asp-items="@ViewBag.Clasess" id="class-dropdown" onchange="SelectClass()" style="border-radius: 19px;">
                                <option value="">Select Class</option>

                            </select>
                        </div>
                    </div>
                    </br>

                    <div class="col-md-12 local-forms label">
                        <div style="position: relative;">
                            <label id="label-color">Section<span class="login-danger">*</span></label>

                            <select id="SectionId"  class="form-control" asp-for="SectionId">
                                <!-- Options will be added here dynamically -->
                                <option>Select Section</option>
                            </select>
                        </div>
                    </div>

  
                    </br>

                    <div class="col-md-12 local-forms label">
                        <div style="position: relative;">
                            <label id="label-color">Subject <span class="login-danger">*</span></label>
                            <select class="form-control" name="SubjectId" style="padding-right: 30px;">
                                <option value="">Select Subject</option>
                                @foreach (var item in ViewBag.Subject as SelectList)
                                {
                                    <option value="@item.Value">@item.Text</option>
                                }
                            </select>
                        </div>
                    </div>

                    <div class="inputContainer">
                        <label class="formLabel requiredLabel"> Lesson Name*</label>
                        <input type="text" placeholder="Subject Name" asp-for="LessonName" required class="formInput" />
                    </div>

                    <div class="buttonContainer">
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                  @*   <div class="buttonContainer">
                        <button type="submit" class="btn btn-primary">Create</button>
                    </div> *@
                </form>
            </div>
        </div>

        <div class="col-md-8 " id="classFormContainers">
            <div class="style-0" id="SubjectDataId" style="max-width:100%; margin:0px;">
                <div class="table-responsive">
                <table id="LessonId" class="display mt-2" style="width:100%">
                    <thead style="background-color:rgb(94, 114, 228);">
                        <tr style="color: white;">
                            <th>Class</th>
                            <th>Section</th>
                            <th>Subject</th>
                            <th>Lesson Name</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data will be populated by DataTables -->
                    </tbody>
                </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="editLessonModal" tabindex="-1" role="dialog" aria-labelledby="editLessonModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editLessonModalLabel">Edit Lesson</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editLessonForm" method="post" action="@Url.Action("CreateLesson", "LessonPlan")">
                        <input type="hidden" id="editLessonId" name="Id" />

                        <div class="inputContainer">
                            <label class="formLabel requiredLabel">Class Name*</label>
                            <select id="editLessonClass" name="ClassId" required class="formInput">
                                <!-- Options will be populated dynamically -->
                            </select>
                        </div>
                        <div class="inputContainer">
                            <label class="formLabel requiredLabel">Section Name*</label>
                            <select id="editLessonSection" name="SectionId" required class="formInput">
                                <!-- Options will be populated dynamically -->
                            </select>
                        </div>
                        <div class="inputContainer">
                            <label class="formLabel requiredLabel">Subject Name*</label>
                            <select id="editLessonSubject" name="SubjectId" required class="formInput">
                                <!-- Options will be populated dynamically -->
                            </select>
                        </div>
                        <div class="inputContainer">
                            <label class="formLabel requiredLabel">Lesson Name*</label>
                            <input type="text" id="editLessonName" name="LessonName" required class="formInput" />
                        </div>
                        <div class="buttonContainer">
                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>





</div>
  


</div>
@section Scripts{
    <script>
        $(document).ready(function () {
            $('#LessonId').DataTable({
                "ajax": {
                    "url": "/Admin/LessonPlan/LessonList",
                    "type": "GET",
                    "dataType": "json",
                    "dataSrc": "data"
                },
                "columns": [
                    { "data": "className" },
                    { "data": "sectionName" },
                    { "data": "subjectName" },
                    { "data": "lessonName" },
                    {
                        "data": null,
                        "render": function (data, type, row) {
                            return `
                                <div class="container">
                                    <button class="btn btn-primary btn-sm edit-btn" data-id="${data.id}" data-class-id="${data.classId}" data-section-id="${data.sectionId}" data-subject-id="${data.subjectId}" data-lesson-name="${data.lessonName}" data-bs-toggle="modal" data-bs-target="#editLessonModal">
                                        <i style="font-size:15px" class="fa">&#xf044;</i>
                                    </button>
                                    <button class="btn btn-danger btn-sm delete-btn" data-id="${data.id}">
                                        <i style="font-size:15px" class="fa">&#xf1f8;</i>
                                    </button>
                                </div>
                            `;
                        }
                    }
                ]
            });

            $('#LessonId').on('click', '.edit-btn', function () {
                var id = $(this).data('id');
                var classId = $(this).data('class-id');
                var sectionId = $(this).data('section-id');
                var subjectId = $(this).data('subject-id');
                var lessonName = $(this).data('lesson-name');

                $('#editLessonId').val(id);
                $('#editLessonName').val(lessonName);

                $.when(
                    $.get('/Admin/LessonPlan/GetClasses'),
                    $.get('/Admin/LessonPlan/GetSections'),
                    $.get('/Admin/LessonPlan/GetSubjects')
                ).done(function (classesResponse, sectionsResponse, subjectsResponse) {
                    var classes = classesResponse[0];
                    var sections = sectionsResponse[0];
                    var subjects = subjectsResponse[0];

                    $('#editLessonClass').empty();
                    $('#editLessonSection').empty();
                    $('#editLessonSubject').empty();

                    classes.forEach(function (item) {
                        var selected = item.id == classId ? 'selected' : '';
                        $('#editLessonClass').append(`<option value="${item.id}" ${selected}>${item.className}</option>`);
                    });

                    subjects.forEach(function (item) {
                        var selected = item.id == subjectId ? 'selected' : '';
                        $('#editLessonSubject').append(`<option value="${item.id}" ${selected}>${item.subjectName}</option>`);
                    });

                    // Trigger change event to update sections dropdown
                    $('#editLessonClass').val(classId).change();

                    $('#editLessonModal').modal('show');
                });
            });

            // Handle class dropdown change
            $('#editLessonClass').change(function () {
                var classId = $(this).val();

                if (classId) {
                    $.get(`/Admin/LessonPlan/GetSectionsByClassId?classId=${classId}`, function (sections) {
                        $('#editLessonSection').empty();
                        sections.forEach(function (section) {
                            var selected = section.id == $('#editLessonSection').data('section-id') ? 'selected' : '';
                            $('#editLessonSection').append(`<option value="${section.id}" ${selected}>${section.name}</option>`);
                        });
                    });
                } else {
                    $('#editLessonSection').empty();
                }
            });

            $('#editLessonForm').submit(function (e) {
                e.preventDefault();
                var formData = $(this).serialize();

                $.ajax({
                    url: '/Admin/LessonPlan/CreateLesson',
                    type: 'POST',
                    data: formData,
                    success: function (response) {
                        if (response.isSuccess) {
                            $('#LessonId').DataTable().ajax.reload();
                            toastr.success(response.message);
                            $('#editLessonModal').modal('hide');
                        } else {
                            toastr.error(response.message || 'An error occurred while trying to update the lesson.');
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error updating lesson:', error);
                        console.error('Status:', status);
                        console.error('XHR:', xhr);
                        toastr.error('An error occurred while trying to update the lesson. Please try again.');
                    }
                });
            });
        });


        

        // Handle Add Button Click

        $(document).ready(function () {
            $('#addLessonForm').submit(function (e) {
                e.preventDefault();

                var formData = $(this).serialize();

                $.ajax({
                    url: '/Admin/LessonPlan/CreateLesson',
                    type: 'POST',
                    data: formData,
                    success: function (response) {
                        if (response.isSuccess) {
                            $('#LessonId').DataTable().ajax.reload(); // Ensure this ID and initialization are correct
                            toastr.success('Lesson added successfully.');
                            $('#addLessonForm')[0].reset();
                        } else {
                            toastr.error(response.Message);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error adding lesson:', error);
                        console.error('Status:', status);
                        console.error('XHR:', xhr);
                        toastr.error('An error occurred while trying to add the lesson. Please try again.');
                    }
                });
            });
        });
        // Handle Edit Button Click
        // $('#LessonId').on('click', '.edit-btn', function () {
        //     // Get data attributes from the clicked edit button
        //     var id = $(this).data('id');
        //     var name = $(this).data('class-name');
        //     var lesson = $(this).data('lesson-name');
        //     var section = $(this).data('section-name');
        //     var subject = $(this).data('subject-name');

        //     // Populate the edit form fields with the fetched data
        //     $('#editLessonId').val(id);
        //     $('#editLessonClass').val(name);
        //     $('#editLessonName').val(lesson);
        //     $('#editLessonSection').val(section);
        //     $('#editLessonSubject').val(subject);

        //     // Show the edit modal
        //     $('#editLessonModal').modal('show');
        // });

      

        // Handle Delete Button Click
        $('#LessonId').on('click', '.delete-btn', function () {
            var lessonId = $(this).data('id');

            if (confirm('Are you sure you want to delete this lesson?')) {
                $.ajax({
                    url: '/Admin/LessonPlan/DeleteLesson',
                    type: 'POST',
                    data: { id: lessonId },
                    success: function (response) {
                        if (response.isSuccess) {
                            $('#LessonId').DataTable().ajax.reload();
                            toastr.success('lesson deleted successfully.');
                        } else {
                            toastr.error(response.Message);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error deleting subject:', error);
                        console.error('Status:', status);
                        console.error('XHR:', xhr);
                        toastr.error('An error occurred while trying to delete the subject. Please try again.');
                    }
                });
            }
        });

      
               
    </script>
    <script>
        function SelectClass() {
            var classId = $('#class-dropdown').val();

            if (!classId) {
                return; // No class selected, do nothing
            }

            $.ajax({
                type: "GET",
                url: "/Admin/AdmissionManagement/GetTheRelatedSection",
                data: { classId: classId },
                success: function (data) {
                    var sectionDropdown = $('#SectionId');
                    sectionDropdown.empty();  // Clear existing options

                    // Add default option
                    sectionDropdown.append('<option value="">Select Section</option>');

                    // Check if data.data is defined and has length
                    if (data && data.data && data.data.length > 0) {
                        // Iterate through data.data and add options
                        $.each(data.data, function (index, item) {
                            sectionDropdown.append('<option value="' + item.id + '">' + item.name + '</option>');
                        });
                    } else {
                        console.error("No data or incorrect data format received.");
                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching section data:", status, error);
                }
            });
        }


    </script>
    <script>
    
        $(document).ready(function () {
            $('#example').DataTable({
                responsive: true
            });
        });
    </script>
}
